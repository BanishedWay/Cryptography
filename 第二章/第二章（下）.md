# 第二章（下）

- [第二章（下）](#第二章下)
  - [费尔马定理](#费尔马定理)
  - [欧拉函数](#欧拉函数)
    - [欧拉定理](#欧拉定理)
    - [欧拉定理推论](#欧拉定理推论)
  - [素性检验](#素性检验)
      - [引理](#引理)
        - [逆否命题](#逆否命题)
  - [Miller and Rabin算法](#miller-and-rabin算法)

## 费尔马定理

若p是素数，a是正整数且gcd(a,p)=1，则$a^{p-1}\equiv 1\quad mod\quad p$

![18](picture/18.png)

推论：设p是素数，a是一正整数，则$a^p\equiv a\quad mod\quad p$ 

>$a=7,p=19$
>
>$7^2=49\equiv 11\quad mod\quad 19$
>
>$7^4\equiv 121\equiv 7\quad mod\quad 19$
>
>$7^8\equiv 49\equiv 11\quad mod\quad 19$
>
>$7^{16}\equiv 121\equiv 7\quad mod\quad 19$
>
>$a^{p-1}=7^{18}=7^{16}\times 7^2\equiv 7\times 11\equiv 1\quad mod\quad 19 $

## 欧拉函数

- 设n是一正整数，小于n且与n互为素数的正整数的个数称为n的欧拉函数，记为$\varphi(n) $
  例如$\varphi(6)=2, \varphi(7)=6, \varphi(8)=4 $
- 若n是素数，则$\varphi(n)=n-1 $
- 定理：若n是两个素数p和q的乘积，则
  $\varphi(n)=\varphi(p)\times\varphi(q)=(p-1)\times(q-1) $
  例如：$21=3\times7$，得$\varphi(21)=\varphi(3)\times\varphi(7)=2\times6=12 $

### 欧拉定理

若a和n互素，则$a^{\varphi(n)}\equiv1(mod\quad n) $

>证明
>
>![19](picture/19.png)

### 欧拉定理推论

>$a^{\varphi(n)+1}\equiv a(mod\quad n) $
>
>若$n=pq,p!=q且都是素数，k为任意正整数，则： $
>$m^{k(p-q)(q-1)+1}\equiv m\quad mod\quad n，对任意的0<=m<=n$

![20](picture/20.png)

p, q互为素数，则$3^{4+1}\equiv 3(mod\quad n) $

![21](picture/21.png)

p, q不是素数，此时使用欧拉定理推论 
$10^{(5-1)(2-1)+1}\equiv 10\equiv0(mod\quad 5) $

## 素性检验

指对给定的数检验是否为素数
- 直接判断一个整数是否为素数是困难的
- 对于大数的素性检验来说没有简单直接地方法，目前常用地是概率检验法，如Miller-Rabin算法
- 素数分布密度：在n范围内：平均每$\ln{n}$个整数中有一个素数。所有平均而言，在找到一个素数之前，需要测试地整数个数为$0.5\ln{n} $ 
  
#### 引理

如果p为大于2的素数，则方程$x^2\equiv 1(mod\quad p) $的解只有$x\equiv 1和x\equiv-1 $

![22](picture/22.png)

##### 逆否命题

如果$x^2\equiv1\quad mod\quad p $有一解不为{1,-1}，则p不为素数

![23](picture/23.png)

## Miller and Rabin算法

- 目前没有一个高效的算法，实际应用最广泛的是Miller and Rabin算法
- 对奇函数n>=3可代表为$n-1=2^kq $，其中k>0，q为奇数
  ![24](picture/24.png)